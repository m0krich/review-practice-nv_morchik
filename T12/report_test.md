# Отладчики и дизассемблеры: теория и практика

## 1. Основные понятия

### 1. Что такое отладчик и для чего он используется?

**Отладчик (debugger)** — это программный инструмент, позволяющий выполнять анализ и модификацию поведения программы во время её выполнения. Он помогает находить и исправлять ошибки (баги) в коде.

**Основные функции отладчика:**
- Построчное выполнение кода
- Установка точек останова (breakpoints)
- Просмотр значений переменных
- Анализ стека вызовов
- Изменение состояния программы на лету

### 2. В чем разница между отладчиком и дизассемблером?

| Функция | Отладчик | Дизассемблер |
|--------|----------|--------------|
| Работает с исполняемым файлом или исходным кодом | + | + |
| Может запускать программу по шагам | + | - |
| Позволяет устанавливать точки останова | + | - |
| Представляет машинный код в виде ассемблера | - | + |
| Используется при динамическом анализе | + | Иногда |
| Используется при статическом анализе | - | + |

Коротко:
- **Отладчик** используется для анализа и изменения поведения программы во время выполнения.
- **Дизассемблер** преобразует машинный код в человеко-читаемый ассемблерный код для анализа без запуска программы.

### 3. Какие типы ошибок можно найти с помощью отладчика?

С помощью отладчика можно обнаруживать следующие типы ошибок:
- **Логические ошибки**: неверная реализация алгоритма
- **Ошибки доступа к памяти**: выход за границы массива, использование неинициализированных указателей
- **Утечки памяти**: выделение памяти без последующего освобождения
- **Арифметические ошибки**: деление на ноль, переполнение чисел
- **Ошибка многопоточности**: race condition, deadlock
- **Неверные значения переменных**: из-за некорректного ввода/обработки данных

### 4. Что такое точка останова (breakpoint)?

**Точка останова (breakpoint)** — это маркер, который устанавливается в определённой строке кода или адресе памяти, чтобы приостановить выполнение программы. Это позволяет проанализировать состояние программы на данном этапе.

**Типы точек останова:**
- Простая точка останова (на строке кода)
- Условная точка останова (срабатывает при выполнении условия)
- Точка останова на изменении значения переменной
- Аппаратные точки останова

---

## 2. Работа с отладчиком

### 5. Как запустить программу в режиме отладки в Visual Studio?

В Visual Studio:
1. Открыть проект.
2. Нажать `F5` или выбрать меню `Debug → Start Debugging`.
3. Программа будет запущена в режиме отладки.
4. Можно использовать команды Step Into, Step Over и т.д.

Также можно добавить точки останова кликом мыши рядом с номером строки.

### 6. Какие основные команды отладчика вы знаете (Step Into, Step Over, Continue)?

| Команда | Описание |
|--------|----------|
| **Step Into (F11)** | Выполняет следующую строку кода, входя в вызываемые функции |
| **Step Over (F10)** | Выполняет следующую строку, не входя в функции |
| **Continue (F5)** | Продолжает выполнение до следующей точки останова |
| **Step Out (Shift + F11)** | Выходит из текущей функции |
| **Break All** | Приостанавливает выполнение программы в любой момент |

### 7. Как просмотреть значения переменных во время отладки?

Можно использовать:
- **Autos / Locals окно**: показывает переменные в текущей области видимости
- **Watch окно**: пользователь может добавить конкретные переменные или выражения
- **DataTips**: наведение мыши на переменную в редакторе кода во время паузы

### 8. Что такое Watch-окно в отладчике? Как его использовать?

**Watch-окно (Watch window)** — это инструмент, позволяющий отслеживать значения определённых переменных или выражений.

**Как использовать:**
1. Во время отладки перейти в меню `Debug → Windows → Watch → Watch 1`
2. Ввести имя переменной или выражение (например, `x + y`)
3. Значения будут обновляться по мере выполнения программы

### 9. Как отладить программу, если она падает без сообщения об ошибке?

Если программа падает без явного сообщения:
- Запустите программу в режиме отладки (`F5`)
- Убедитесь, что включены все возможные исключения: `Debug → Windows → Exception Settings`
- Установите точки останова в ключевых участках кода
- Используйте "Just-In-Time" отладку, если программа завершается вне IDE
- Анализируйте Call Stack, чтобы понять, где произошла ошибка

---

## 3. Дизассемблирование и анализ кода

### 10. Что такое дизассемблер и какие задачи он решает?

**Дизассемблер** — это инструмент, преобразующий машинный код в читаемый ассемблерный код.

**Задачи:**
- Обратная разработка (reverse engineering)
- Анализ вредоносного ПО
- Поиск скрытых функций или багов
- Исследование работы закрытых приложений
- Восстановление утерянного исходного кода

### 11. Какие популярные дизассемблеры вы знаете? (Ghidra, IDA Pro, radare2)

- **Ghidra** — мощный дизассемблер и декомпилятор от NSA. Бесплатный, открытый исходный код.
- **IDA Pro** — коммерческий дизассемблер, один из самых популярных среди профессионалов.
- **radare2** — бесплатный, кроссплатформенный фреймворк для анализа бинарников.
- **Binary Ninja**, **Cutter** (интерфейс для radare2), **Hopper** — тоже популярны.

### 12. Как найти функцию main в дизассемблированной программе?

Способы:
- Искать символ `_main` или `main` в списке функций (если есть debug-информация)
- Следовать за точкой входа (`entry point`) и искать вызов `__libc_start_main` (в Linux)
- В Windows искать `WinMain` или `mainCRTStartup`
- Использовать декомпилятор Ghidra — он часто автоматически помечает `main`

### 13. Как дизассемблер помогает найти проверку пароля в программе?

- Ищутся системные вызовы ввода (например, `scanf`, `ReadFile`)
- Анализируются сравнения (`cmp`, `strcmp`, `memcmp`)
- Отслеживаются условные переходы (`jz`, `jnz`) после сравнения
- Можно искать строку "password", "login", "incorrect" и т.д.
- После этого исследуют блоки кода, где происходит сравнение введённого пароля с эталоном

### 14. Как определить, какие библиотеки использует программа?

В Ghidra:
- Перейти в раздел `Symbols → Externs`
- Там будут перечислены внешние функции и библиотеки, например:
  - `kernel32.dll`, `user32.dll` (Windows)
  - `libc.so`, `libm.so` (Linux)

Также можно использовать:
- **Dependency Walker** (Windows)
- **ldd** (Linux)
- **objdump**, **readelf**

---

## 4. Практическое применение

### 15. Как с помощью отладчика найти ошибку "деление на ноль"?

- Установить точку останова перед операцией деления
- Проверить значение знаменателя через Watch или Autos
- Если деление выполняется внутри функции, использовать Step Into
- Также можно включить отладку исключений (например, ArithmeticException в .NET)

---

## 5. Обратная разработка (Reverse Engineering)

### 16. Как восстановить алгоритм программы, если у вас нет исходного кода?

- Использовать дизассемблер (например, Ghidra)
- Читать ассемблерный код и строить логическую модель
- Использовать декомпиляторы (например, Ghidra умеет декомпилировать в псевдокод C-like)
- Искать повторяющиеся шаблоны: циклы, условия, математические операции
- Проводить динамический анализ (с помощью отладчика), подавая различные входные данные

### 17. Как найти ключевые функции в дизассемблированной программе?

- Поиск строк с ключевыми словами (логины, пароли, ошибки)
- Анализ графа вызовов (Call Graph)
- Использовать сигнатуры известных функций (YARA rules)
- Слежение за вызовами системных API (например, `CreateFile`, `SendMessage`)
- Мониторинг обращений к сети, файлам, реестру

### 18. Как определить, использует ли программа шифрование?

Признаки использования шифрования:
- Наличие длинных случайных строк (ключи)
- Обращение к стандартным библиотекам шифрования (OpenSSL, CryptoAPI)
- Наличие таблиц замены (S-boxes) в коде
- Характерные алгоритмы (AES, RSA, RC4 и т.д.)
- Использование функций хэширования (SHA, MD5)

### 19. Как проанализировать вредоносное ПО с помощью дизассемблера?

Этапы анализа:
- Изучить точку входа и начальный код
- Определить, какие API вызываются (сетевые, файловые, реестровые)
- Искать строки и IP-адреса
- Проследить за потоком управления (control flow)
- Проверить наличие антиотладочных механизмов
- Использовать динамический анализ (в песочнице) вместе со статическим

---

## 6. Дополнительные вопросы

### 20. В чем разница между статическим и динамическим анализом?

| Критерий | Статический анализ | Динамический анализ |
|---------|--------------------|----------------------|
| Выполняется без запуска программы | + | - |
| Анализирует только код | + | - |
| Может обнаружить ошибки до запуска | + | - |
| Требует запуска программы | - | + |
| Позволяет отследить поведение в реальном времени | - | + |
| Применяется в reverse-engineering | + | + |

### 21. Какие этические аспекты нужно учитывать при работе с дизассемблерами и отладчиками?

- **Не нарушать закон**: не взламывать защиту программ без разрешения владельца
- **Не распространять конфиденциальные данные**, полученные в результате анализа
- **Не использовать знания в корыстных целях**
- **Использовать reverse-engineering только в образовательных, исследовательских или легальных целях**
- **Соблюдать соглашения EULA (End User License Agreement)**
